<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>k8s 离线安装 一键安装兼容centos8 &amp;&amp; ubutnu20.04 | Horysk 宏睿时空</title>
    
    
        <meta property="og:site_name" content="Horysk 宏睿时空">
    
    
        <meta property="article:author" content="Hory Skone">
    
    
        <link rel="icon" href="/img/favicon.ico">
    
    
<link rel="stylesheet" href="/css/minireset.min.css">

    
<link rel="stylesheet" href="/css/all.min.css">

    
<link rel="stylesheet" href="/css/csshake.min.css">

    
<link rel="stylesheet" href="/css/hljs/lioshi.css">

    
<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

    
<link rel="stylesheet" href="/styl/main.css">

    
<script src="/js/jquery.min.js"></script>

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/jquery.fancybox.min.js"></script>

    
<script src="/js/clipboard.min.js"></script>

<meta name="generator" content="Hexo 5.2.0"></head>
<body>
    <header>
  <div class="outer">
    <div class="inner">
      <h1 class="logo-wrap">
        <a>Horysk 宏睿时空<b><sup>8.8.8</sup></b></a>
      </h1>
    </div>
    <div class="inner">
      <nav class="main-nav">
        
          <a href="/">首页</a>
        
          <a href="/archives">归档</a>
        
          <a href="/categories">分类</a>
        
          <a href="/tags">标签</a>
        
          <a href="/friends">友链</a>
        
          <a href="/about">关于</a>
        
          <a target="_blank" rel="noopener" href="https://www.hory-ai.com">HORYAI</a>
        
      </nav>
    </div>
  </div>
</header>
    <div class="content">
        <section class="outer">
    <article>
        <div class="article-title">
    <h2>
        <a href="/2016/02/06/k8s%20%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%20%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E5%85%BC%E5%AE%B9centos8%20&&%20ubutnu20.04/" class="shake shake-little" title="k8s 离线安装 一键安装兼容centos8 &amp;&amp; ubutnu20.04">
            
            k8s 离线安装 一键安装兼容centos8 &amp;&amp; ubutnu20.04
        </a>
    </h2>
    <div class="meta_box">
    
        
        
            
                
        
        <div class="meta meta_auth">
            <img src="/img/default.png" alt="head" />
            <p>anonymous</p>
        </div>
    
        
            <div class="meta meta_cate">
                <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
                <p><a class="article-category-link" href="/categories/docker/">docker</a>►<a class="article-category-link" href="/categories/docker/k8s/">k8s</a></p>
            </div>
        
        
        <div class="meta meta_date">
            <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
            <p>发布于：2016年02月06日</p>
        </div>
    
        <div class="meta meta_update">
            <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
            <p>更新于：2016年02月06日</p>
        </div>
    </div>
    
  <div class="post_tags">
    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>k8s</a></li></ul>
  </div>


</div>

        <hr>
        <div class="article-entry">
            
            
            
            <p>K8S 是一个一键安装K8S高可用集群的软件。它可以帮助企业一键搭建完私有云系统，帮助用户在多家云服务商里灵活切换，不再被任何服务商绑架！ 对! 所有的操作只需要一键！</p>
<p>有问题 咨询wechat: horysk</p>
<h1 id="kubernetes-v1-18-2-版本-已经支持-所有监控为最新版本"><a href="#kubernetes-v1-18-2-版本-已经支持-所有监控为最新版本" class="headerlink" title="kubernetes v1.18.2 版本 已经支持, 所有监控为最新版本."></a>kubernetes v1.18.2 版本 已经支持, 所有监控为最新版本.</h1><p>安装很简单， 一键安装，安装一个系统只需要 3 分钟, 安装好以后完整的监控也一并装好，可以直接使用。（不止支持单master 还支持3master 高可用方案)</p>
<h1 id="同时安装三台-方案"><a href="#同时安装三台-方案" class="headerlink" title="同时安装三台 方案:"></a>同时安装三台 方案:</h1><p>记住服务版本 linux AMD64的安装包才是我们支持的。</p>
<p>好现在开始安装，高可用系统 需要3台服务器，我们这里假设3台主机，ip 分别是10.0.0.4, 10.0.0.5,10.0.0.6</p>
<h2 id="好我们需要做下面4件事"><a href="#好我们需要做下面4件事" class="headerlink" title="好我们需要做下面4件事"></a>好我们需要做下面4件事</h2><p>把安装包installer, pack.xxx.xxx.bin 文件 以及kubernetes的官方文件复制到每台主机上<br>在其中一台 运行 sudo ./installer -genkey -hostlist=10.0.0.0 运行完毕，会生成一个k8skey.pem文件，将它复制到其他的主机上<br>在每台主机上运行一次 sudo ./installer –prepare<br>在3台主机上同时运行 sudo ./installer -kubernetestarfile kubernetes-server-linux-amd64.tar.gz -masterip=10.0.0.4,10.0.0.5,10.0.0.6<br>参数说明 -kubernetestarfile kubernetes-server-linux-amd64.tar.gz 是指 使用 kubernetes-server-linux-amd64.tar.gz 这个文件作为kubernetes的官方软件。<br>-masterip=10.0.0.4,10.0.0.5,10.0.0.6 是指 我们选择 10.0.0.4 10.0.0.5 10.0.0.6 作为master节点</p>
<p>剩下的？ 等待就可以了。<br>等安装成功后 你用浏览器访问一下 10.0.0.4:10000 看看，一个新的世界给你准备好了。</p>
<p>你需要下载pack.xxx.xxx.bin 文件和installer 文件。</p>
<p>此外 你还需选择一个kubernetes 的官方发行包。你可以在这里找到官方发行包</p>
<h1 id="安装主机-后添加-方案二"><a href="#安装主机-后添加-方案二" class="headerlink" title="安装主机  后添加  方案二:"></a>安装主机  后添加  方案二:</h1><h2 id="2条命令即可"><a href="#2条命令即可" class="headerlink" title="2条命令即可"></a>2条命令即可</h2><p>#创建密钥<br>sudo ./installer –genkey -hostlist=172.20.2.66</p>
<h2 id="提示kernel-不够请升级centos-kernel-参考"><a href="#提示kernel-不够请升级centos-kernel-参考" class="headerlink" title="提示kernel 不够请升级centos kernel  参考"></a>提示kernel 不够请升级centos kernel  参考<a href></a></h2><h2 id="报错-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory-请参考一下处理方案"><a href="#报错-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory-请参考一下处理方案" class="headerlink" title="报错 sysctl: cannot stat /proc/sys/net/netfilter/nf_conntrack_max: No such file or directory  请参考一下处理方案"></a>报错 sysctl: cannot stat /proc/sys/net/netfilter/nf_conntrack_max: No such file or directory  请参考一下处理方案</h2><p>#创建集群<br>sudo ./installer   -kubernetestarfile kubernetes-server-linux-amd64.tar.gz -masterip 172.20.2.66<br>image</p>
<h1 id="将一个新节点加入这个集群也只需要一个命令"><a href="#将一个新节点加入这个集群也只需要一个命令" class="headerlink" title="将一个新节点加入这个集群也只需要一个命令"></a>将一个新节点加入这个集群也只需要一个命令</h1><p>1条命令即可</p>
<h1 id="将密钥复制到本地"><a href="#将密钥复制到本地" class="headerlink" title="将密钥复制到本地"></a>将密钥复制到本地</h1><p>cp ../k8skey.pem ./</p>
<h1 id="将机器加入集群"><a href="#将机器加入集群" class="headerlink" title="将机器加入集群"></a>将机器加入集群</h1><p>sudo ./installer   -kubernetestarfile kubernetes-server-linux-amd64.tar.gz -masterip 172.20.2.66</p>
<p><a target="_blank" rel="noopener" href="https://github.com/horysk/k8seasy_release_page">github</a><br><a target="_blank" rel="noopener" href="http://dl.k8seasy.com/">link</a></p>
<h2 id="报错-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory"><a href="#报错-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory" class="headerlink" title="报错: sysctl: cannot stat /proc/sys/net/netfilter/nf_conntrack_max: No such file or directory"></a>报错: sysctl: cannot stat /proc/sys/net/netfilter/nf_conntrack_max: No such file or directory</h2><p>执行如下</p>
<p>lsmod |grep conntrack</p>
<p>如何返回是空，表示没有加载，那执行如下命令加载即可</p>
<p>modprobe ip_conntrack</p>
<p>再重新执行验证</p>
<p>[root@k8s-node-n2 ~]# lsmod |grep conntrack<br>nf_conntrack_ipv4 20480 0<br>nf_defrag_ipv4 16384 1 nf_conntrack_ipv4<br>nf_conntrack 114688 1 nf_conntrack_ipv4</p>
<p>再重新手动刷新使文件生效就没有问题了</p>
<p>sysctl -p /etc/sysctl.d/kubernetes.conf</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/de4ae3812b04">参考</a></p>

        </div>
        <div class="article-copyright">
            
    <blockquote>
        <p>
            版权声明：本文为「宏睿时空」的原创文章，博客内容遵循 署名-非商业性使用-相同方式共享 协议。<br>本文永久链接是�http://blog.hory-ai.com/2016/02/06/k8s%20%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%20%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E5%85%BC%E5%AE%B9centos8%20&&%20ubutnu20.04/
        </p>
    </blockquote>


        </div>
    </article>
    

    <section id="toc-div" >
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#kubernetes-v1-18-2-%E7%89%88%E6%9C%AC-%E5%B7%B2%E7%BB%8F%E6%94%AF%E6%8C%81-%E6%89%80%E6%9C%89%E7%9B%91%E6%8E%A7%E4%B8%BA%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC"><span class="toc-text">kubernetes v1.18.2 版本 已经支持, 所有监控为最新版本.</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E5%AE%89%E8%A3%85%E4%B8%89%E5%8F%B0-%E6%96%B9%E6%A1%88"><span class="toc-text">同时安装三台 方案:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%BD%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%81%9A%E4%B8%8B%E9%9D%A24%E4%BB%B6%E4%BA%8B"><span class="toc-text">好我们需要做下面4件事</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%BB%E6%9C%BA-%E5%90%8E%E6%B7%BB%E5%8A%A0-%E6%96%B9%E6%A1%88%E4%BA%8C"><span class="toc-text">安装主机  后添加  方案二:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%9D%A1%E5%91%BD%E4%BB%A4%E5%8D%B3%E5%8F%AF"><span class="toc-text">2条命令即可</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E7%A4%BAkernel-%E4%B8%8D%E5%A4%9F%E8%AF%B7%E5%8D%87%E7%BA%A7centos-kernel-%E5%8F%82%E8%80%83"><span class="toc-text">提示kernel 不够请升级centos kernel  参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory-%E8%AF%B7%E5%8F%82%E8%80%83%E4%B8%80%E4%B8%8B%E5%A4%84%E7%90%86%E6%96%B9%E6%A1%88"><span class="toc-text">报错 sysctl: cannot stat &#x2F;proc&#x2F;sys&#x2F;net&#x2F;netfilter&#x2F;nf_conntrack_max: No such file or directory  请参考一下处理方案</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86%E4%B8%80%E4%B8%AA%E6%96%B0%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E8%BF%99%E4%B8%AA%E9%9B%86%E7%BE%A4%E4%B9%9F%E5%8F%AA%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4"><span class="toc-text">将一个新节点加入这个集群也只需要一个命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86%E5%AF%86%E9%92%A5%E5%A4%8D%E5%88%B6%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="toc-text">将密钥复制到本地</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%86%E6%9C%BA%E5%99%A8%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">将机器加入集群</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99-sysctl-cannot-stat-proc-sys-net-netfilter-nf-conntrack-max-No-such-file-or-directory"><span class="toc-text">报错: sysctl: cannot stat &#x2F;proc&#x2F;sys&#x2F;net&#x2F;netfilter&#x2F;nf_conntrack_max: No such file or directory</span></a></li></ol></li></ol>
    </section>
    <section id="gohome" style="display: none;"><a>顶</a></section>

    <script>
        function get_top_by_link(link){
            var hnid = "#" + $(link).attr("data");
            if ($(hnid).length > 0){
                return $(hnid).offset().top;
            }else{
                return 0;
            }
        }
        //go to hn
        function gotohn(link){
            $("html,body").animate({scrollTop: get_top_by_link(link) }, 300);
        }
        //页面滚动
        function update(){
            var scrollH = $(window).scrollTop();
            if($(".toc-link")){
                $(".toc-link").each(function(i,link){
                    var mdHeight = get_top_by_link(link);
                    if(mdHeight <= scrollH + 40){
                        //高亮导航菜单
                        $('.toc-link').removeClass('on');
                        $(link).addClass('on');
                    }
                });
            }
            //返回顶部显隐
            if(scrollH < 200){
                $("#gohome").css("display","none");
            }else{
                $("#gohome").css("display","block");
            }
        }
        $(function(){
            //修复部分锚点从属关系
            if($("#toc-div >li").length > 0){
                $("#toc-div >li").appendTo($("#toc-div >ol:first"));
            }
            //返回顶部
            $('#gohome').click(function(){
                $("html,body").animate({scrollTop: 0}, 300);
                return false;
            })
            //遍历锚点
            $(".toc-link").each(function(i,link){
                $(link).attr("data",$(link).attr('href').substring(1));
                $(link).attr("href","javascript:void(0);");
                $(link).attr("onclick","gotohn(this);");
            })
            //绑定滚动事件
            $(window).bind('scroll', update);
            //初始化toc
            var first_toc = $(".toc-link")[0];
            var first_scroll = get_top_by_link(first_toc);
            var window_scroll = $(window).scrollTop();
            if(window_scroll <= first_scroll){
                $(first_toc).addClass('on');
            }
        })
    </script>

</section>
    </div>
    <footer>
    <div class="outer">
        <div class="inner">
            Powered by <a href="http://prowiki.demopage.icu/" target="_blank">ProWiki</a>
            &copy;2020 HORYSK<br>
            <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">粤ICP备6896438749号</a>
        </div>
    </div>
</footer>

<script src="/js/custom.js"></script>


    <script>onload_content();</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":true}});</script></body>
</html>
